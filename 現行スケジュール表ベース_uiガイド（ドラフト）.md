# 現行スケジュール表ベース UIガイド（ドラフト）

本ガイドは、現行の「職員×日（1か月1シート）」表をできるだけ踏襲しつつ、アプリ化した際に操作性と検証性（違反可視化）を上げるためのUI指針をまとめたもの。

参照元：アップロードPDF「R7年度 すずかけスケジュール - 2月」（全4ページ）。fileciteturn0file0  
（以降の「現行表」所見は、同PDFの表構造・配色・記載パターンに基づく）

---

## 1. 現行表の構造（観察）
### 1.1 俯瞰レイアウト
- **横方向：担当者（職員）列**
  - 上段に職員名が並ぶ（例：藤田／小石／三田村…等）。fileciteturn0file0L1-L8
- **縦方向：日付（行）**
  - 左端に日付と曜日、祝日名が入り、週ごとに区切られる（例：建国記念日、天皇誕生日）。fileciteturn0file0L23-L26
- **日付行は「AM/PM」＋「15-18時帯（1時間刻み）」のブロック構造**
  - 多くの日で AM／PM の2段があり、その下に 15時/16時/17時/18- の枠が続く。fileciteturn0file0L47-L55

### 1.2 左側の“予定”欄の役割
- 左端付近に「予定」欄があり、その日のプログラム概要（例：節分、料理、テーマトーク、パソコン教室等）が長文で入る。fileciteturn0file0L31-L40
- 「DNC」「DC」「NC」などの業務カテゴリ（デイ/ナイト関連）が併記される。fileciteturn0file0L1-L8

### 1.3 1セル内に“複数要素”が混在
- 同じ時間枠の中に
  - 担当者の配置（DC参加メンバー等）
  - 個別案件（検査・面接・説明会等：時間・対象者名）
  - 共有タスク（会議、準備、振り返り、事務局など）
  が縦書き/改行で混在する。fileciteturn0file0L9-L20

---

## 2. 色（セル背景）の意味とUI方針
### 2.1 現行の主要配色（ユーザー定義）
- **赤：休み**
- **ピンク：出勤前**
- **紫：退勤後**
- **緑：訪問**
（ユーザー要件）

### 2.2 UI設計の原則
- 色は「**状態**」として扱い、業務コード（内容）とは分離する
  - 例：同じ「面接」でも「出勤前」ならピンク帯、勤務時間内なら白地、退勤後なら紫帯。
- 画面上に常時「**凡例（Legend）**」を表示し、
  - 管理者が色・意味を編集可能
  - 印刷時も凡例が出る
- 色弱対応として **色だけに依存しない**
  - 休み：斜線ハッチ、訪問：アイコン（🚲/🚗）等を併用

### 2.3 現行表に見られる“追加色”への扱い
- PDF上では赤・緑・紫・ピンク以外に、黄色帯や水色帯等の強調が見られる（週末や会議帯など）。fileciteturn0file0
- アプリでは
  - 追加色＝「カスタム状態」枠として登録できる
  - 初期状態は4色（赤/ピンク/紫/緑）を固定、追加は管理画面から

---

## 3. グリッド（時間×職員）UI仕様
### 3.1 画面の向き（現行踏襲）
- **縦：日付、横：職員** を基本とする（現行と同じ読み順）。fileciteturn0file0

### 3.2 時間粒度
- 表示は **1時間刻み**
- 1日の構造は
  - AM（午前）
  - PM（午後）
  - 15/16/17/18-（夕方枠）
  の“セクション”で折り畳めるようにする（現行の視線誘導を踏襲）。fileciteturn0file0L47-L55
- 将来拡張（内部15分等）は内部都合として吸収し、表示は当面1時間。

### 3.3 ヘッダ固定・スクロール
- 横スクロール：職員列が多いので必須
  - **上部：職員名ヘッダを固定**
- 縦スクロール：月全体で必須
  - **左側：日付・曜日・祝日表示を固定**
  - 日付セクション（1日分）単位で“スナップ”して止まると見やすい

### 3.4 週区切り・休日の視覚表現
- 週の境界は太線（現行踏襲）
- 祝日や日曜は背景を薄く変える＋ラベル（祝日名）を表示。fileciteturn0file0L23-L26

---

## 4. セルの中身（情報の階層化）
現行の「1セルに長文・複数要素」を、アプリでは“見た目は近く、データは分離”する。

### 4.1 表示（セル内）
- 1行目：**業務コード（短い）**（例：DC/NC/訪問/面接/検査 など）
- 2行目：**対象**（患者名/案件名/プログラム名）
- 3行目以降：**メモ（省略表示）**
- 長文はセル内に詰め込まず、
  - ホバー/クリックでポップオーバーに全文
  - 右側サイドパネルに詳細

### 4.2 「予定（左欄）」の扱い
- 現行の左欄（その日の概要）は、アプリでも **Day Summary（当日概要）** として保持。
- 位置は
  - A案：現行同様に左端固定カラム
  - B案：日付ヘッダをクリックでサマリーが展開（折り畳み）

### 4.3 “イベント”と“シフト”の同居
- 同一時間に
  - デイケア参加（複数職員）
  - 個別面接/検査（部屋枠2）
  - 訪問（車1/自転車2）
  が並立するため、セルは「担当割当」だけでなく「イベント参照」を表示できる必要がある。

---

## 5. 入力・編集の操作設計（Excel互換を最優先）
### 5.1 基本操作
- クリック：業務コード選択（候補リスト）
- ダブルクリック：詳細編集（対象名、場所、メモ、資源）
- ドラッグ：連続時間に伸ばす（所要時間）
- コピー/ペースト：Excel的に複数セルへ貼り付け
- 右クリック：色（状態）変更（休み/出勤前/退勤後/訪問）

### 5.2 “自然文入力”の入口
- 画面上部に「自然文入力バー」
  - 例：「山田さんの心理検査2回目を今月木曜午後のどこか」
- 入力後
  - イベントが作成される（未割当）
  - 候補枠がハイライト
  - 推奨スロット/担当候補が提示

### 5.3 即時検証（色とは別の警告レイヤ）
- 休み等の状態色に加えて、
  - **違反は枠線/バッジ**（赤枠、⚠️）
  - クリックで理由（例：部屋枠超過、車不足、資格不足）
- 「満たせない条件」も一覧で出し、セル上ではバッジで示す。

---

## 6. 画面モード（利用シーン別）
### 6.1 作成モード
- 編集可能
- 違反/未充足を常時表示
- 右パネルにイベント一覧（未割当→割当済）

### 6.2 閲覧モード（配布用）
- 編集不可
- 印刷レイアウト最適化
- 個別案件の詳細はクリックで表示（紙に出す場合は省略）

### 6.3 印刷/PDF
- 現行の「1か月1シート」感を維持
- ページ分割（週単位/半月単位）を選べる
- 凡例（色の意味）は必ず出力

---

## 7. UIで“現場の暗黙知”を壊さない工夫
- ルールがテンプレ化されていない条件（仮ルール）は、
  - セル上に「📝（未検証）」バッジ
  - 月末に「未検証ルール一覧」を自動生成
- 左欄（当日概要）と、個別イベント（面接/検査等）の両方を見ながら調整できる導線を確保。

---

## 8. 初期UIスタイル指針（現行近似）
- グリッド線は細く、週境界・日境界は太め（現行踏襲）
- フォントは可読性重視（小さく詰めすぎない）
- 文字は「セル中央に縦方向に詰める」より、
  - 先頭に要点（コード）
  - 詳細は展開
  で情報過密を回避

---

## 9. 今後の精密化（次にやると良いこと）
- 現行表で使われている「業務コードの実リスト（DC/NC/検査/面接/振休等）」を抽出し、
  - コード辞書（表示名・デフォルト時間・必要資源）
  - セル表示の優先順位（何を1行目に出すか）
  を確定する。
- 色（状態）以外に使われている水色/黄色などの意味を棚卸しし、凡例に追加する。

